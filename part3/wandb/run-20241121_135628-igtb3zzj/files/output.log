/root/Codes/part3/rnn/data.py:358: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  tensor_data = torch.load(f'{input_dir}/tensor_data.pt')
tensor([[ 0.0000e+00,  1.0000e+00,  0.0000e+00,  ...,  1.0000e+00,
          0.0000e+00,  1.0000e+00],
        [ 8.4147e-01,  5.4030e-01,  6.8156e-01,  ...,  1.0000e+00,
          1.3335e-04,  1.0000e+00],
        [ 9.0930e-01, -4.1615e-01,  9.9748e-01,  ...,  1.0000e+00,
          2.6670e-04,  1.0000e+00],
        ...,
        [ 9.0179e-01, -4.3218e-01,  6.2345e-02,  ...,  9.9997e-01,
          6.1342e-03,  9.9998e-01],
        [ 1.2357e-01, -9.9234e-01, -6.3461e-01,  ...,  9.9997e-01,
          6.2675e-03,  9.9998e-01],
        [-7.6825e-01, -6.4014e-01, -9.9112e-01,  ...,  9.9996e-01,
          6.4009e-03,  9.9998e-01]])
Parameters: 2.89M
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(49, 64)
    (layers): ModuleList(
      (0-15): 16 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=64, out_features=512, bias=False)
          (k_proj): Linear(in_features=64, out_features=512, bias=False)
          (v_proj): Linear(in_features=64, out_features=512, bias=False)
          (o_proj): Linear(in_features=512, out_features=64, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=64, out_features=256, bias=False)
          (up_proj): Linear(in_features=64, out_features=256, bias=False)
          (down_proj): Linear(in_features=256, out_features=64, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((64,), eps=1e-05)
        (post_attention_layernorm): LlamaRMSNorm((64,), eps=1e-05)
      )
    )
    (norm): LlamaRMSNorm((64,), eps=1e-05)
    (rotary_emb): LlamaRotaryEmbedding()
  )
  (lm_head): Linear(in_features=64, out_features=49, bias=False)
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:03<00:00, 11.67it/s]
Initial | val loss: 13.00484058856964 | val acc: 0.0
start training
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.72it/s]
Step 0 | Train loss | 13.13498306274414 | Samples 0 | Train acc: 0.0 | Val loss: 13.00484058856964 | Val acc: 0.0 | learning rate: 3.846153846153846e-06
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.73it/s]
Step 782 | Train loss | 2.691563292785927 | Samples 100096 | Train acc: 0.0 | Val loss: 1.8522371083498002 | Val acc: 0.0 | learning rate: 0.0002990288263900567
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.74it/s]
Step 1563 | Train loss | 0.788175502244164 | Samples 200064 | Train acc: 0.002230713828425096 | Val loss: 1.1351796984672546 | Val acc: 0.0246 | learning rate: 0.00029570127048704877
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.70it/s]
Step 2344 | Train loss | 0.1772062247241738 | Samples 300032 | Train acc: 0.1299315781049936 | Val loss: 0.1275967013090849 | Val acc: 0.3678 | learning rate: 0.00029005890029289914
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 14.13it/s]
Step 3125 | Train loss | 0.021370589244522044 | Samples 400000 | Train acc: 0.4628881241997439 | Val loss: 0.06287174606695771 | Val acc: 0.5272 | learning rate: 0.0002821913583969805
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.75it/s]
Step 3907 | Train loss | 0.011126439747693229 | Samples 500096 | Train acc: 0.5628996163682864 | Val loss: 0.04522917699068785 | Val acc: 0.619 | learning rate: 0.0002722095948580161
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.72it/s]
Step 4688 | Train loss | 0.006619073081531995 | Samples 600064 | Train acc: 0.668944062099872 | Val loss: 0.031212477944791317 | Val acc: 0.7254 | learning rate: 0.00026029768893862337
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.75it/s]
Step 5469 | Train loss | 0.003578748506999539 | Samples 700032 | Train acc: 0.7952144686299616 | Val loss: 0.031346240639686586 | Val acc: 0.7788 | learning rate: 0.00024663343957169893
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.75it/s]
Step 6250 | Train loss | 0.0019523428246161973 | Samples 800000 | Train acc: 0.8902348751600512 | Val loss: 0.01026879424462095 | Val acc: 0.928 | learning rate: 0.00023143393614573303
 40%|███████████████████████████████████████████████████████████████████████████████████▌                                                                                                                             | 7813/19531 [26:37<39:55,  4.89it/s]
Step 7032 | Train loss | 0.0011197148073270238 | Samples 900096 | Train acc: 0.9322650255754475 | Val loss: 0.0064707805053330954 | Val acc: 0.9572 | learning rate: 0.0002149188218693342
