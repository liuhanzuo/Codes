/root/Codes/part3/rnn/data.py:358: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  tensor_data = torch.load(f'{input_dir}/tensor_data.pt')
tensor([[ 0.0000e+00,  1.0000e+00,  0.0000e+00,  ...,  1.0000e+00,
          0.0000e+00,  1.0000e+00],
        [ 8.4147e-01,  5.4030e-01,  6.8156e-01,  ...,  1.0000e+00,
          1.3335e-04,  1.0000e+00],
        [ 9.0930e-01, -4.1615e-01,  9.9748e-01,  ...,  1.0000e+00,
          2.6670e-04,  1.0000e+00],
        ...,
        [ 9.0179e-01, -4.3218e-01,  6.2345e-02,  ...,  9.9997e-01,
          6.1342e-03,  9.9998e-01],
        [ 1.2357e-01, -9.9234e-01, -6.3461e-01,  ...,  9.9997e-01,
          6.2675e-03,  9.9998e-01],
        [-7.6825e-01, -6.4014e-01, -9.9112e-01,  ...,  9.9996e-01,
          6.4009e-03,  9.9998e-01]])
Parameters: 1.44M
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(49, 64)
    (layers): ModuleList(
      (0-7): 8 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=64, out_features=512, bias=False)
          (k_proj): Linear(in_features=64, out_features=512, bias=False)
          (v_proj): Linear(in_features=64, out_features=512, bias=False)
          (o_proj): Linear(in_features=512, out_features=64, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=64, out_features=256, bias=False)
          (up_proj): Linear(in_features=64, out_features=256, bias=False)
          (down_proj): Linear(in_features=256, out_features=64, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((64,), eps=1e-05)
        (post_attention_layernorm): LlamaRMSNorm((64,), eps=1e-05)
      )
    )
    (norm): LlamaRMSNorm((64,), eps=1e-05)
    (rotary_emb): LlamaRotaryEmbedding()
  )
  (lm_head): Linear(in_features=64, out_features=49, bias=False)
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 33.79it/s]
Initial | val loss: 13.343663638151146 | val acc: 0.0
start training
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.43it/s]
Step 0 | Train loss | 13.381623268127441 | Samples 0 | Train acc: 0.0 | Val loss: 13.343663638151146 | Val acc: 0.0 | learning rate: 6.41025641025641e-07
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.41it/s]
Step 782 | Train loss | 3.984593947728475 | Samples 50048 | Train acc: 0.0 | Val loss: 2.5248611637308627 | Val acc: 0.0 | learning rate: 9.998404459589077e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.32it/s]
Step 1563 | Train loss | 1.0467429923279512 | Samples 100032 | Train acc: 0.0 | Val loss: 1.9331536127042166 | Val acc: 0.0 | learning rate: 9.991955766863001e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.43it/s]
Step 2344 | Train loss | 0.6287971156492417 | Samples 150016 | Train acc: 0.0 | Val loss: 1.8527426191523104 | Val acc: 0.0 | learning rate: 9.980564049517183e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.34it/s]
Step 3125 | Train loss | 0.4563749714761076 | Samples 200000 | Train acc: 0.0 | Val loss: 1.7868030161797246 | Val acc: 0.0 | learning rate: 9.964240587607363e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.44it/s]
Step 3907 | Train loss | 0.3488384056969821 | Samples 250048 | Train acc: 0.0 | Val loss: 1.6974598999264874 | Val acc: 0.0 | learning rate: 9.942971207381999e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.35it/s]
Step 4688 | Train loss | 0.2666339917995447 | Samples 300032 | Train acc: 0.0 | Val loss: 1.490583831750894 | Val acc: 0.0 | learning rate: 9.916831362647369e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.25it/s]
Step 5469 | Train loss | 0.1936996653049476 | Samples 350016 | Train acc: 2.000640204865557e-05 | Val loss: 1.214247370068031 | Val acc: 0.0 | learning rate: 9.885822881327851e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.40it/s]
Step 6250 | Train loss | 0.13907144193057347 | Samples 400000 | Train acc: 0.0003201024327784891 | Val loss: 1.0166037882430643 | Val acc: 0.0016 | learning rate: 9.849976467959655e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.19it/s]
Step 7032 | Train loss | 0.10543177640744875 | Samples 450048 | Train acc: 0.0025975063938618926 | Val loss: 0.887789513491377 | Val acc: 0.0068 | learning rate: 9.809272508632586e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 46.96it/s]
Step 7813 | Train loss | 0.08278931747899813 | Samples 500032 | Train acc: 0.009423015364916774 | Val loss: 0.76432238047636 | Val acc: 0.016 | learning rate: 9.763855401943554e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.38it/s]
Step 8594 | Train loss | 0.06730403380729627 | Samples 550016 | Train acc: 0.016685339308578746 | Val loss: 0.6967508408087718 | Val acc: 0.0194 | learning rate: 9.713721135160076e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.44it/s]
Step 9375 | Train loss | 0.0551941949467305 | Samples 600000 | Train acc: 0.02464788732394366 | Val loss: 0.6316641357880605 | Val acc: 0.03 | learning rate: 9.658919351132882e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.34it/s]
Step 10157 | Train loss | 0.045474869296831935 | Samples 650048 | Train acc: 0.035266144501278775 | Val loss: 0.5250442797624613 | Val acc: 0.0466 | learning rate: 9.599425306353598e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.30it/s]
Step 10938 | Train loss | 0.036132617113478864 | Samples 700032 | Train acc: 0.050556177976952624 | Val loss: 0.4733904615233216 | Val acc: 0.0618 | learning rate: 9.535450057847943e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.44it/s]
Step 11719 | Train loss | 0.029141426490740564 | Samples 750016 | Train acc: 0.06752160691421255 | Val loss: 0.40769838155070437 | Val acc: 0.078 | learning rate: 9.466983815762905e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.46it/s]
Step 12500 | Train loss | 0.023952741456903386 | Samples 800000 | Train acc: 0.08756802176696543 | Val loss: 0.3430326309385179 | Val acc: 0.097 | learning rate: 9.394094375234508e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.40it/s]
Step 13282 | Train loss | 0.019446480938767774 | Samples 850048 | Train acc: 0.10735693734015345 | Val loss: 0.30728745724581463 | Val acc: 0.1208 | learning rate: 9.316752254937093e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 47.29it/s]
Step 14063 | Train loss | 0.015884010789786657 | Samples 900032 | Train acc: 0.13804417413572342 | Val loss: 0.28155701843243613 | Val acc: 0.1398 | learning rate: 9.235231828514843e-05
 20%|█████████████████████████████████████████▌                                                                                                                                                                      | 15625/78125 [13:45<55:00, 18.94it/s]
Step 14844 | Train loss | 0.012618334735431587 | Samples 950016 | Train acc: 0.1722351152368758 | Val loss: 0.21945975626571268 | Val acc: 0.1726 | learning rate: 9.149517684003656e-05
