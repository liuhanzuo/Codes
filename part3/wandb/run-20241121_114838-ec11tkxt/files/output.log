/root/Codes/part3/rnn/data.py:358: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  tensor_data = torch.load(f'{input_dir}/tensor_data.pt')
tensor([[ 0.0000e+00,  1.0000e+00,  0.0000e+00,  ...,  1.0000e+00,
          0.0000e+00,  1.0000e+00],
        [ 8.4147e-01,  5.4030e-01,  7.6172e-01,  ...,  1.0000e+00,
          1.1548e-04,  1.0000e+00],
        [ 9.0930e-01, -4.1615e-01,  9.8705e-01,  ...,  1.0000e+00,
          2.3096e-04,  1.0000e+00],
        ...,
        [ 9.0179e-01, -4.3218e-01,  8.4488e-01,  ...,  9.9998e-01,
          5.3120e-03,  9.9999e-01],
        [ 1.2357e-01, -9.9234e-01,  1.3992e-01,  ...,  9.9998e-01,
          5.4274e-03,  9.9999e-01],
        [-7.6825e-01, -6.4014e-01, -6.6357e-01,  ...,  9.9998e-01,
          5.5429e-03,  9.9998e-01]])
Parameters: 4.33M
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(49, 128)
    (layers): ModuleList(
      (0-11): 12 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=128, out_features=512, bias=False)
          (k_proj): Linear(in_features=128, out_features=512, bias=False)
          (v_proj): Linear(in_features=128, out_features=512, bias=False)
          (o_proj): Linear(in_features=512, out_features=128, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=128, out_features=256, bias=False)
          (up_proj): Linear(in_features=128, out_features=256, bias=False)
          (down_proj): Linear(in_features=256, out_features=128, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((128,), eps=1e-05)
        (post_attention_layernorm): LlamaRMSNorm((128,), eps=1e-05)
      )
    )
    (norm): LlamaRMSNorm((128,), eps=1e-05)
    (rotary_emb): LlamaRotaryEmbedding()
  )
  (lm_head): Linear(in_features=128, out_features=49, bias=False)
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 13.52it/s]
Initial | val loss: 24.23471541404724 | val acc: 0.0
start training
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.27it/s]
Step 0 | Train loss | 24.15688705444336 | Samples 0 | Train acc: 0.0 | Val loss: 24.23471541404724 | Val acc: 0.0 | learning rate: 3.846153846153846e-06
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.72it/s]
Step 40 | Train loss | 11.762933137940198 | Samples 5120 | Train acc: 0.0 | Val loss: 4.695524251461029 | Val acc: 0.0 | learning rate: 0.0001576923076923077
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.20it/s]
Step 79 | Train loss | 1.9271421313285828 | Samples 10112 | Train acc: 0.0 | Val loss: 3.6403948068618774 | Val acc: 0.0 | learning rate: 0.00029999998775023383
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.07it/s]
Step 118 | Train loss | 1.1762619178836085 | Samples 15104 | Train acc: 0.0 | Val loss: 3.545797860622406 | Val acc: 0.0 | learning rate: 0.00029999485206516277
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.16it/s]
Step 157 | Train loss | 0.8665397846246068 | Samples 20096 | Train acc: 0.0 | Val loss: 3.4571769773960113 | Val acc: 0.0 | learning rate: 0.00029998040080076084
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.11it/s]
Step 196 | Train loss | 0.6667989329033092 | Samples 25088 | Train acc: 0.0 | Val loss: 3.2284997761249543 | Val acc: 0.0 | learning rate: 0.00029995663485453807
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.98it/s]
Step 235 | Train loss | 0.5010147963540029 | Samples 30080 | Train acc: 0.0 | Val loss: 2.831486386060715 | Val acc: 0.0 | learning rate: 0.0002999235557025023
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.94it/s]
Step 274 | Train loss | 0.3820568006688898 | Samples 35072 | Train acc: 0.0 | Val loss: 2.5685621440410613 | Val acc: 0.0 | learning rate: 0.00029988116539906705
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.16it/s]
Step 313 | Train loss | 0.30060049530806815 | Samples 40064 | Train acc: 0.0 | Val loss: 2.306164437532425 | Val acc: 0.0 | learning rate: 0.0002998294665769243
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.96it/s]
Step 352 | Train loss | 0.24325510530228656 | Samples 45056 | Train acc: 0.0 | Val loss: 2.1349284291267394 | Val acc: 0.0 | learning rate: 0.00029976846244688066
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.01it/s]
Step 391 | Train loss | 0.2095666168903818 | Samples 50048 | Train acc: 0.0 | Val loss: 2.074073451757431 | Val acc: 0.0 | learning rate: 0.00029969815679765834
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.55it/s]
Step 430 | Train loss | 0.18470689924023267 | Samples 55040 | Train acc: 0.0 | Val loss: 2.0233550757169723 | Val acc: 0.0 | learning rate: 0.0002996185539956595
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.99it/s]
Step 469 | Train loss | 0.16607372354953848 | Samples 60032 | Train acc: 0.0 | Val loss: 1.9951959878206253 | Val acc: 0.0 | learning rate: 0.00029952965898469525
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.06it/s]
Step 508 | Train loss | 0.151988744033109 | Samples 65024 | Train acc: 0.0 | Val loss: 1.9617593973875045 | Val acc: 0.0 | learning rate: 0.00029943147728567866
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.48it/s]
Step 547 | Train loss | 0.1386929572063641 | Samples 70016 | Train acc: 0.0 | Val loss: 1.9396666139364243 | Val acc: 0.0 | learning rate: 0.0002993240149962816
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.02it/s]
Step 586 | Train loss | 0.12802342275947687 | Samples 75008 | Train acc: 0.0 | Val loss: 1.9153704583644866 | Val acc: 0.0 | learning rate: 0.0002992072787905564
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.08it/s]
Step 625 | Train loss | 0.11884157250102717 | Samples 80000 | Train acc: 0.0 | Val loss: 1.9015330731868745 | Val acc: 0.0 | learning rate: 0.00029908127591852114
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.52it/s]
Step 665 | Train loss | 0.11348081440538973 | Samples 85120 | Train acc: 0.0 | Val loss: 1.8850544095039368 | Val acc: 0.0 | learning rate: 0.00029894242428324885
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.98it/s]
Step 704 | Train loss | 0.10359150788462754 | Samples 90112 | Train acc: 0.0 | Val loss: 1.8600907534360887 | Val acc: 0.0 | learning rate: 0.0002987976750550119
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.90it/s]
Step 743 | Train loss | 0.09721400420511922 | Samples 95104 | Train acc: 0.0 | Val loss: 1.8437588602304458 | Val acc: 0.0 | learning rate: 0.0002986436845993118
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.60it/s]
Step 782 | Train loss | 0.0916976660756468 | Samples 100096 | Train acc: 0.0 | Val loss: 1.831201931834221 | Val acc: 0.0 | learning rate: 0.00029848046247987883
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.91it/s]
Step 821 | Train loss | 0.08702606455833083 | Samples 105088 | Train acc: 0.0 | Val loss: 1.8099556863307953 | Val acc: 0.0 | learning rate: 0.00029830801883378496
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.93it/s]
Step 860 | Train loss | 0.08208740671337274 | Samples 110080 | Train acc: 0.0 | Val loss: 1.804709780216217 | Val acc: 0.0 | learning rate: 0.00029812636437081413
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.97it/s]
Step 899 | Train loss | 0.07742114557160272 | Samples 115072 | Train acc: 0.0 | Val loss: 1.7896860510110855 | Val acc: 0.0 | learning rate: 0.00029793551037279734
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.96it/s]
Step 938 | Train loss | 0.07329866325004666 | Samples 120064 | Train acc: 0.0 | Val loss: 1.7540613889694214 | Val acc: 0.0 | learning rate: 0.0002977354686929117
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.00it/s]
Step 977 | Train loss | 0.06917424801668506 | Samples 125056 | Train acc: 0.0 | Val loss: 1.7047882467508315 | Val acc: 0.0 | learning rate: 0.0002975262517549445
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.99it/s]
Step 1016 | Train loss | 0.06463628474003914 | Samples 130048 | Train acc: 0.0 | Val loss: 1.6435819298028946 | Val acc: 0.0 | learning rate: 0.0002973078725525217
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.87it/s]
Step 1055 | Train loss | 0.06019343955047203 | Samples 135040 | Train acc: 0.0 | Val loss: 1.5817605286836625 | Val acc: 0.0 | learning rate: 0.0002970803446483005
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.91it/s]
Step 1094 | Train loss | 0.05630066394805908 | Samples 140032 | Train acc: 0.0 | Val loss: 1.548570653796196 | Val acc: 0.0 | learning rate: 0.00029684368217312753
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.02it/s]
Step 1133 | Train loss | 0.051640093536814265 | Samples 145024 | Train acc: 0.0 | Val loss: 1.466179519891739 | Val acc: 0.0002 | learning rate: 0.000296597899825161
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.06it/s]
Step 1172 | Train loss | 0.047497616907723014 | Samples 150016 | Train acc: 0.00020032051282051281 | Val loss: 1.3928647249937058 | Val acc: 0.0008 | learning rate: 0.0002963430128689578
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.93it/s]
Step 1211 | Train loss | 0.0420224661677584 | Samples 155008 | Train acc: 0.002003205128205128 | Val loss: 1.2355695068836212 | Val acc: 0.0038 | learning rate: 0.0002960790371345257
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.02it/s]
Step 1250 | Train loss | 0.038322181724530044 | Samples 160000 | Train acc: 0.0028044871794871795 | Val loss: 1.152848908305168 | Val acc: 0.0024 | learning rate: 0.0002958059890163399
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.04it/s]
Step 1290 | Train loss | 0.03319667814130658 | Samples 165120 | Train acc: 0.005859375 | Val loss: 1.0164946451783181 | Val acc: 0.0028 | learning rate: 0.0002955165331304568
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.05it/s]
Step 1329 | Train loss | 0.028350025998022322 | Samples 170112 | Train acc: 0.005809294871794872 | Val loss: 0.8996039092540741 | Val acc: 0.0102 | learning rate: 0.0002952251601751321
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.87it/s]
Step 1368 | Train loss | 0.02508635896239688 | Samples 175104 | Train acc: 0.011618589743589744 | Val loss: 0.8280393034219742 | Val acc: 0.0114 | learning rate: 0.00029492476786693075
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.98it/s]
Step 1407 | Train loss | 0.02174802924591032 | Samples 180096 | Train acc: 0.02123397435897436 | Val loss: 0.7495886653661727 | Val acc: 0.0188 | learning rate: 0.0002946153748620156
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.92it/s]
Step 1446 | Train loss | 0.01828021725540583 | Samples 185088 | Train acc: 0.02283653846153846 | Val loss: 0.6116356983780861 | Val acc: 0.0248 | learning rate: 0.0002942970003755465
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.83it/s]
Step 1485 | Train loss | 0.015422793809690513 | Samples 190080 | Train acc: 0.028245192307692308 | Val loss: 0.5411666132509708 | Val acc: 0.0456 | learning rate: 0.00029396966418048745
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.87it/s]
Step 1524 | Train loss | 0.013344397896625957 | Samples 195072 | Train acc: 0.047275641025641024 | Val loss: 0.5246291555464268 | Val acc: 0.0296 | learning rate: 0.000293633386606378
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.97it/s]
Step 1563 | Train loss | 0.012576919592097592 | Samples 200064 | Train acc: 0.04707532051282051 | Val loss: 0.47299577444791796 | Val acc: 0.055 | learning rate: 0.0002932881885380711
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.90it/s]
Step 1602 | Train loss | 0.010544463629582786 | Samples 205056 | Train acc: 0.08453525641025642 | Val loss: 0.3988687194883823 | Val acc: 0.0692 | learning rate: 0.0002929340914144358
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.99it/s]
Step 1641 | Train loss | 0.009640131721978647 | Samples 210048 | Train acc: 0.08173076923076923 | Val loss: 0.39068948701024053 | Val acc: 0.0858 | learning rate: 0.00029257111722702576
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.92it/s]
Step 1680 | Train loss | 0.008624763839093084 | Samples 215040 | Train acc: 0.09575320512820513 | Val loss: 0.33469865322113035 | Val acc: 0.1298 | learning rate: 0.0002921992885187136
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.80it/s]
Step 1719 | Train loss | 0.007438651108464529 | Samples 220032 | Train acc: 0.12079326923076923 | Val loss: 0.2885782554745674 | Val acc: 0.1504 | learning rate: 0.00029181862838229065
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.96it/s]
Step 1758 | Train loss | 0.006930277691841668 | Samples 225024 | Train acc: 0.1346153846153846 | Val loss: 0.29844911843538285 | Val acc: 0.1412 | learning rate: 0.00029142916045903306
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.99it/s]
Step 1797 | Train loss | 0.00599883223269487 | Samples 230016 | Train acc: 0.15244391025641027 | Val loss: 0.25197345241904257 | Val acc: 0.1714 | learning rate: 0.00029103090893723305
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.89it/s]
Step 1836 | Train loss | 0.005118070434926967 | Samples 235008 | Train acc: 0.18549679487179488 | Val loss: 0.23658268637955188 | Val acc: 0.2072 | learning rate: 0.0002906238985506972
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.10it/s]
Step 1875 | Train loss | 0.004916231332620832 | Samples 240000 | Train acc: 0.20012019230769232 | Val loss: 0.22078703790903093 | Val acc: 0.2228 | learning rate: 0.00029020815457720994
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.98it/s]
Step 1915 | Train loss | 0.004464823231567669 | Samples 245120 | Train acc: 0.2197265625 | Val loss: 0.186467444896698 | Val acc: 0.239 | learning rate: 0.0002897727051913397
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.85it/s]
Step 1954 | Train loss | 0.003746925991819338 | Samples 250112 | Train acc: 0.24178685897435898 | Val loss: 0.1778856910765171 | Val acc: 0.2598 | learning rate: 0.000289339349796602
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.03it/s]
Step 1993 | Train loss | 0.003465103857973992 | Samples 255104 | Train acc: 0.2686298076923077 | Val loss: 0.17552533261477948 | Val acc: 0.2754 | learning rate: 0.00028889734059308974
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.89it/s]
Step 2032 | Train loss | 0.0031230138899713566 | Samples 260096 | Train acc: 0.29967948717948717 | Val loss: 0.15650793574750424 | Val acc: 0.28 | learning rate: 0.0002884467050322236
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.94it/s]
Step 2071 | Train loss | 0.0029871219042760526 | Samples 265088 | Train acc: 0.28145032051282054 | Val loss: 0.1462581902742386 | Val acc: 0.3152 | learning rate: 0.000287987471101173
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.83it/s]
Step 2110 | Train loss | 0.0027750998467192837 | Samples 270080 | Train acc: 0.3125 | Val loss: 0.1323867630213499 | Val acc: 0.3252 | learning rate: 0.00028751966732111744
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 16.11it/s]
Step 2149 | Train loss | 0.002548110984092535 | Samples 275072 | Train acc: 0.32311698717948717 | Val loss: 0.14300347492098808 | Val acc: 0.285 | learning rate: 0.0002870433227454756
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.99it/s]
Step 2188 | Train loss | 0.0022827188151238876 | Samples 280064 | Train acc: 0.3423477564102564 | Val loss: 0.11389196645468473 | Val acc: 0.3728 | learning rate: 0.0002865584669581005
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.97it/s]
Step 2227 | Train loss | 0.0022036542336805933 | Samples 285056 | Train acc: 0.3651842948717949 | Val loss: 0.12932838294655086 | Val acc: 0.346 | learning rate: 0.0002860651300714428
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.85it/s]
Step 2266 | Train loss | 0.0019800886216014297 | Samples 290048 | Train acc: 0.3707932692307692 | Val loss: 0.11763044614344835 | Val acc: 0.3742 | learning rate: 0.00028556334272468003
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40/40 [00:02<00:00, 15.83it/s]
Step 2305 | Train loss | 0.001934338199477142 | Samples 295040 | Train acc: 0.3880208333333333 | Val loss: 0.10394502729177475 | Val acc: 0.3988 | learning rate: 0.00028505313608181385
 15%|███████████████████████████████▊                                                                                                                                                                                 | 2376/15625 [09:25<38:20,  5.76it/s]Traceback (most recent call last):
Step 2344 | Train loss | 0.0016738168275686723 | Samples 300032 | Train acc: 0.40604967948717946 | Val loss: 0.09271919596940278 | Val acc: 0.426 | learning rate: 0.00028453454182973486
  File "rnn/train.py", line 241, in <module>
    main()
  File "rnn/train.py", line 238, in main
    train(model, optimizer, scheduler, train_loader, val_loader, args)
  File "rnn/train.py", line 93, in train
    loss.backward()
  File "/root/miniconda3/lib/python3.8/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/root/miniconda3/lib/python3.8/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/root/miniconda3/lib/python3.8/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
