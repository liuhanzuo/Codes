/root/Codes/part3/rnn/data.py:358: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  tensor_data = torch.load(f'{input_dir}/tensor_data.pt')
torch.Size([56, 64])
Parameters: 0.52M
Loading...
rnn/train.py:224: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(args.previous_model_path)
MambaLMHeadModel(
  (backbone): MixerModel(
    (embedding): Embedding(56, 64)
    (layers): ModuleList(
      (0-15): 16 x Block(
        (norm): RMSNorm()
        (mixer): Mamba(
          (in_proj): Linear(in_features=64, out_features=256, bias=False)
          (conv1d): Conv1d(128, 128, kernel_size=(4,), stride=(1,), padding=(3,), groups=128)
          (act): SiLU()
          (x_proj): Linear(in_features=128, out_features=36, bias=False)
          (dt_proj): Linear(in_features=4, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=64, bias=False)
        )
      )
    )
    (norm_f): RMSNorm()
  )
  (lm_head): Linear(in_features=64, out_features=56, bias=False)
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:06<00:00,  3.04it/s]
Initial | val loss: 0.48357810229063036 | val acc: 0.0764
start training
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 0 | Train loss | 0.4725781977176666 | Samples 0 | Train acc: 0.078125 | Val loss: 0.48357810229063036 | Val acc: 0.0764 | learning rate: 7.692307692307693e-05
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.63it/s]
Step 20 | Train loss | 0.13321763117398536 | Samples 5120 | Train acc: 0.3287109375 | Val loss: 0.06469518188387155 | Val acc: 0.448 | learning rate: 0.0016153846153846153
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.60it/s]
Step 40 | Train loss | 0.022212120454485822 | Samples 10240 | Train acc: 0.509765625 | Val loss: 0.03431708971038461 | Val acc: 0.5788 | learning rate: 0.0029999999220693694
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.52it/s]
Step 59 | Train loss | 0.009118806291371583 | Samples 15104 | Train acc: 0.5958059210526315 | Val loss: 0.02641064450144768 | Val acc: 0.6138 | learning rate: 0.0029999914081560953
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.50it/s]
Step 79 | Train loss | 0.00628593114670366 | Samples 20224 | Train acc: 0.628125 | Val loss: 0.02409101603552699 | Val acc: 0.6404 | learning rate: 0.002999967249771349
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.71it/s]
Step 98 | Train loss | 0.0047811169478327335 | Samples 25088 | Train acc: 0.6188322368421053 | Val loss: 0.024051106441766022 | Val acc: 0.6282 | learning rate: 0.0029999298629783656
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.79it/s]
Step 118 | Train loss | 0.003864156317059733 | Samples 30208 | Train acc: 0.6486328125 | Val loss: 0.02433844283223152 | Val acc: 0.6416 | learning rate: 0.002999875312717306
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.78it/s]
Step 137 | Train loss | 0.0032263644633517747 | Samples 35072 | Train acc: 0.6358963815789473 | Val loss: 0.023767825122922658 | Val acc: 0.6438 | learning rate: 0.002999809054521791
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.76it/s]
Step 157 | Train loss | 0.002967759766439094 | Samples 40192 | Train acc: 0.637109375 | Val loss: 0.02415281943976879 | Val acc: 0.6386 | learning rate: 0.002999724114539737
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.67it/s]
Step 176 | Train loss | 0.002625760469732985 | Samples 45056 | Train acc: 0.6338404605263158 | Val loss: 0.02495157578960061 | Val acc: 0.6388 | learning rate: 0.0029996289875595986
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.79it/s]
Step 196 | Train loss | 0.0023871377337402497 | Samples 50176 | Train acc: 0.6431640625 | Val loss: 0.02384860347956419 | Val acc: 0.6394 | learning rate: 0.0029995136612125887
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.79it/s]
Step 215 | Train loss | 0.0020594472600216113 | Samples 55040 | Train acc: 0.6383634868421053 | Val loss: 0.024151788838207722 | Val acc: 0.6322 | learning rate: 0.00299938966920636
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.73it/s]
Step 235 | Train loss | 0.002134585997752719 | Samples 60160 | Train acc: 0.61640625 | Val loss: 0.026269097067415714 | Val acc: 0.62 | learning rate: 0.0029992439610510182
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 254 | Train loss | 0.001964893199357332 | Samples 65024 | Train acc: 0.6038240131578947 | Val loss: 0.027925391867756843 | Val acc: 0.5918 | learning rate: 0.0029990911089177105
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 274 | Train loss | 0.001887648884545673 | Samples 70144 | Train acc: 0.6095703125 | Val loss: 0.025540730357170104 | Val acc: 0.6258 | learning rate: 0.002998915024711069
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.71it/s]
Step 293 | Train loss | 0.0016842947854679457 | Samples 75008 | Train acc: 0.6299342105263158 | Val loss: 0.025322330370545387 | Val acc: 0.6232 | learning rate: 0.002998733318489977
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 313 | Train loss | 0.0016537403308187321 | Samples 80128 | Train acc: 0.619140625 | Val loss: 0.027746955398470163 | Val acc: 0.5994 | learning rate: 0.0029985268651892454
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.82it/s]
Step 333 | Train loss | 0.001642695148503352 | Samples 85248 | Train acc: 0.6095703125 | Val loss: 0.025081983674317597 | Val acc: 0.6232 | learning rate: 0.0029983048410827024
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 352 | Train loss | 0.0013538880310636067 | Samples 90112 | Train acc: 0.6264391447368421 | Val loss: 0.02588620809838176 | Val acc: 0.626 | learning rate: 0.002998079497822002
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.91it/s]
Step 372 | Train loss | 0.001415794225904002 | Samples 95232 | Train acc: 0.61640625 | Val loss: 0.02709949854761362 | Val acc: 0.6066 | learning rate: 0.002997827117426962
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.90it/s]
Step 391 | Train loss | 0.0013430472035721249 | Samples 100096 | Train acc: 0.6083470394736842 | Val loss: 0.027726421039551495 | Val acc: 0.6164 | learning rate: 0.002997572940285136
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.88it/s]
Step 411 | Train loss | 0.001265018011976793 | Samples 105216 | Train acc: 0.625390625 | Val loss: 0.029323147237300874 | Val acc: 0.5914 | learning rate: 0.002997290213573326
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.84it/s]
Step 430 | Train loss | 0.001175301270494605 | Samples 110080 | Train acc: 0.619860197368421 | Val loss: 0.02633440252393484 | Val acc: 0.621 | learning rate: 0.002997007212593092
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.90it/s]
Step 450 | Train loss | 0.0012158006966576608 | Samples 115200 | Train acc: 0.6177734375 | Val loss: 0.025664037745445966 | Val acc: 0.6204 | learning rate: 0.0029966941507352414
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 469 | Train loss | 0.0010976161252945027 | Samples 120064 | Train acc: 0.6186266447368421 | Val loss: 0.02469668909907341 | Val acc: 0.6282 | learning rate: 0.002996382337098165
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 489 | Train loss | 0.0011171384391431905 | Samples 125184 | Train acc: 0.613671875 | Val loss: 0.03028235984966159 | Val acc: 0.5868 | learning rate: 0.002996038952463567
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.84it/s]
Step 508 | Train loss | 0.0015034444030001027 | Samples 130048 | Train acc: 0.5532483552631579 | Val loss: 0.04011006336659193 | Val acc: 0.5598 | learning rate: 0.0029956983384896245
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.78it/s]
Step 528 | Train loss | 0.0015341080513928923 | Samples 135168 | Train acc: 0.54296875 | Val loss: 0.047303376533091065 | Val acc: 0.5076 | learning rate: 0.002995324644645647
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 547 | Train loss | 0.0014765205704709039 | Samples 140032 | Train acc: 0.53125 | Val loss: 0.03571069845929742 | Val acc: 0.5582 | learning rate: 0.0029949552437927344
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.73it/s]
Step 567 | Train loss | 0.0012520427363072063 | Samples 145152 | Train acc: 0.553515625 | Val loss: 0.034363611973822115 | Val acc: 0.5572 | learning rate: 0.002994551255504282
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 586 | Train loss | 0.0010355885411903033 | Samples 150016 | Train acc: 0.5789473684210527 | Val loss: 0.03062849259003997 | Val acc: 0.5906 | learning rate: 0.0029941530823676854
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.76it/s]
Step 606 | Train loss | 0.0009776249104463289 | Samples 155136 | Train acc: 0.594921875 | Val loss: 0.028509782254695894 | Val acc: 0.5972 | learning rate: 0.0029937188155966187
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.80it/s]
Step 625 | Train loss | 0.0008507317896134937 | Samples 160000 | Train acc: 0.6060855263157895 | Val loss: 0.029322965536266565 | Val acc: 0.6008 | learning rate: 0.0029932918859084377
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 645 | Train loss | 0.0009238359780734169 | Samples 165120 | Train acc: 0.598828125 | Val loss: 0.03036809777840972 | Val acc: 0.5868 | learning rate: 0.0029928273578129407
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.82it/s]
Step 665 | Train loss | 0.0008979324508715678 | Samples 170240 | Train acc: 0.592578125 | Val loss: 0.02829968500882387 | Val acc: 0.6014 | learning rate: 0.0029923473181337422
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.84it/s]
Step 684 | Train loss | 0.000776800651946207 | Samples 175104 | Train acc: 0.6169819078947368 | Val loss: 0.026863275002688168 | Val acc: 0.618 | learning rate: 0.002991876917375369
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 704 | Train loss | 0.000801903506120046 | Samples 180224 | Train acc: 0.60703125 | Val loss: 0.02838048981502652 | Val acc: 0.6102 | learning rate: 0.002991366644601351
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.90it/s]
Step 723 | Train loss | 0.0006876594556793983 | Samples 185088 | Train acc: 0.6151315789473685 | Val loss: 0.02715627495199442 | Val acc: 0.6152 | learning rate: 0.0029908675318364706
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.88it/s]
Step 743 | Train loss | 0.0007438862305735388 | Samples 190208 | Train acc: 0.607421875 | Val loss: 0.03171600326895714 | Val acc: 0.596 | learning rate: 0.002990327046128868
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 762 | Train loss | 0.0007408113630188246 | Samples 195072 | Train acc: 0.5962171052631579 | Val loss: 0.029436369985342027 | Val acc: 0.5956 | learning rate: 0.0029897992410777745
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.84it/s]
Step 782 | Train loss | 0.0007202864563899022 | Samples 200192 | Train acc: 0.6041015625 | Val loss: 0.02859950652346015 | Val acc: 0.6054 | learning rate: 0.0029892285637915564
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 801 | Train loss | 0.0007132714651432121 | Samples 205056 | Train acc: 0.5906661184210527 | Val loss: 0.03127079801633954 | Val acc: 0.5828 | learning rate: 0.0029886720873081966
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.82it/s]
Step 821 | Train loss | 0.0007492361699033827 | Samples 210176 | Train acc: 0.5837890625 | Val loss: 0.031054080557078124 | Val acc: 0.5846 | learning rate: 0.0029880712409912223
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 840 | Train loss | 0.0006952924625095374 | Samples 215040 | Train acc: 0.5865542763157895 | Val loss: 0.029800886288285255 | Val acc: 0.5996 | learning rate: 0.0029874861150623717
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 860 | Train loss | 0.0006589879661486954 | Samples 220160 | Train acc: 0.6134765625 | Val loss: 0.02786625437438488 | Val acc: 0.6008 | learning rate: 0.0029868551234544993
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 879 | Train loss | 0.0006235053889792074 | Samples 225024 | Train acc: 0.5921052631578947 | Val loss: 0.02851231172680855 | Val acc: 0.6038 | learning rate: 0.0029862413711988925
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 899 | Train loss | 0.0006291190079516835 | Samples 230144 | Train acc: 0.6076171875 | Val loss: 0.02736571477726102 | Val acc: 0.5992 | learning rate: 0.0029855802592310423
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 918 | Train loss | 0.0006001400817043763 | Samples 235008 | Train acc: 0.5962171052631579 | Val loss: 0.029297444596886636 | Val acc: 0.5986 | learning rate: 0.002984937904898461
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 938 | Train loss | 0.0006364424523517601 | Samples 240128 | Train acc: 0.58671875 | Val loss: 0.029429642390459775 | Val acc: 0.5904 | learning rate: 0.0029842466986916296
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 958 | Train loss | 0.0006225136039745571 | Samples 245248 | Train acc: 0.581640625 | Val loss: 0.03218126455321908 | Val acc: 0.5862 | learning rate: 0.0029835400700605097
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 977 | Train loss | 0.0005711662451639497 | Samples 250112 | Train acc: 0.600328947368421 | Val loss: 0.028563832491636278 | Val acc: 0.5986 | learning rate: 0.0029828544945261714
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.82it/s]
Step 997 | Train loss | 0.0005977127312837479 | Samples 255232 | Train acc: 0.59375 | Val loss: 0.03216552529484033 | Val acc: 0.569 | learning rate: 0.0029821178134321453
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.77it/s]
Step 1016 | Train loss | 0.0005541406022412235 | Samples 260096 | Train acc: 0.6019736842105263 | Val loss: 0.029300210997462273 | Val acc: 0.5976 | learning rate: 0.0029814037017416293
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 1036 | Train loss | 0.0005914034858963874 | Samples 265216 | Train acc: 0.587890625 | Val loss: 0.035973259806633 | Val acc: 0.5626 | learning rate: 0.0029806369972914825
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.74it/s]
Step 1055 | Train loss | 0.0006292049603706056 | Samples 270080 | Train acc: 0.553453947368421 | Val loss: 0.03914424628019333 | Val acc: 0.5362 | learning rate: 0.002979894377659841
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 1075 | Train loss | 0.0007504403009512168 | Samples 275200 | Train acc: 0.5421875 | Val loss: 0.04168417658656835 | Val acc: 0.538 | learning rate: 0.0029790976801466035
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 1094 | Train loss | 0.0007024885244565467 | Samples 280064 | Train acc: 0.5380345394736842 | Val loss: 0.036553453747183086 | Val acc: 0.5566 | learning rate: 0.0029783265819152585
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.79it/s]
Step 1114 | Train loss | 0.0008116320844722971 | Samples 285184 | Train acc: 0.5224609375 | Val loss: 0.04264229517430067 | Val acc: 0.5214 | learning rate: 0.0029774999228170066
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.75it/s]
Step 1133 | Train loss | 0.0006996040746595914 | Samples 290048 | Train acc: 0.5217927631578947 | Val loss: 0.04054618999361992 | Val acc: 0.5346 | learning rate: 0.0029767003764525884
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.79it/s]
Step 1153 | Train loss | 0.000639461029314499 | Samples 295168 | Train acc: 0.5560546875 | Val loss: 0.031938398256897926 | Val acc: 0.5864 | learning rate: 0.0029758437884312016
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.90it/s]
Step 1172 | Train loss | 0.0005292123309054745 | Samples 300032 | Train acc: 0.591077302631579 | Val loss: 0.03202882297337055 | Val acc: 0.5824 | learning rate: 0.002975015825524347
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.80it/s]
Step 1192 | Train loss | 0.0005777324225881574 | Samples 305152 | Train acc: 0.5751953125 | Val loss: 0.034587747883051634 | Val acc: 0.5642 | learning rate: 0.002974129342424218
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 1211 | Train loss | 0.0005165265562633673 | Samples 310016 | Train acc: 0.5727796052631579 | Val loss: 0.03086997801437974 | Val acc: 0.5866 | learning rate: 0.0029732729956883207
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.84it/s]
Step 1231 | Train loss | 0.0004909005191467412 | Samples 315136 | Train acc: 0.5814453125 | Val loss: 0.030501239374279975 | Val acc: 0.5908 | learning rate: 0.002972356652535017
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.89it/s]
Step 1250 | Train loss | 0.00043206528085265323 | Samples 320000 | Train acc: 0.5984786184210527 | Val loss: 0.028300947789102793 | Val acc: 0.6066 | learning rate: 0.0029714719558049368
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 1270 | Train loss | 0.0004368360563936804 | Samples 325120 | Train acc: 0.6041015625 | Val loss: 0.029230606649070977 | Val acc: 0.6052 | learning rate: 0.0029705257888038173
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 1290 | Train loss | 0.000444452322321193 | Samples 330240 | Train acc: 0.603125 | Val loss: 0.03061389084905386 | Val acc: 0.5924 | learning rate: 0.002969564341948843
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.88it/s]
Step 1309 | Train loss | 0.00041183581760593954 | Samples 335104 | Train acc: 0.6202713815789473 | Val loss: 0.028108579479157923 | Val acc: 0.6088 | learning rate: 0.002968636823569327
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 1329 | Train loss | 0.0004338913422105904 | Samples 340224 | Train acc: 0.6052734375 | Val loss: 0.02866311091929674 | Val acc: 0.5948 | learning rate: 0.002967645609878008
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 1348 | Train loss | 0.0004213504214323035 | Samples 345088 | Train acc: 0.602796052631579 | Val loss: 0.02992450362071395 | Val acc: 0.5868 | learning rate: 0.002966689831465884
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 1368 | Train loss | 0.00042323266898218606 | Samples 350208 | Train acc: 0.609765625 | Val loss: 0.027735802996903657 | Val acc: 0.6114 | learning rate: 0.002965668890101767
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 1387 | Train loss | 0.00040587959462180947 | Samples 355072 | Train acc: 0.5869654605263158 | Val loss: 0.029775783140212297 | Val acc: 0.5964 | learning rate: 0.0029646848894205103
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 1407 | Train loss | 0.000387568229184994 | Samples 360192 | Train acc: 0.60859375 | Val loss: 0.026932747289538383 | Val acc: 0.6178 | learning rate: 0.002963634260721703
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 1426 | Train loss | 0.0003745782932432365 | Samples 365056 | Train acc: 0.5990953947368421 | Val loss: 0.0289110223762691 | Val acc: 0.599 | learning rate: 0.0029626220766498686
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.89it/s]
Step 1446 | Train loss | 0.0004030347305511555 | Samples 370176 | Train acc: 0.5966796875 | Val loss: 0.029404132068157195 | Val acc: 0.6052 | learning rate: 0.002961541802127447
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.89it/s]
Step 1465 | Train loss | 0.00036033052229417787 | Samples 375040 | Train acc: 0.6015625 | Val loss: 0.027046183217316867 | Val acc: 0.6054 | learning rate: 0.0029605014746571356
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.87it/s]
Step 1485 | Train loss | 0.00036508606654036575 | Samples 380160 | Train acc: 0.6046875 | Val loss: 0.028963814675807952 | Val acc: 0.5944 | learning rate: 0.002959391596993502
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.75it/s]
Step 1504 | Train loss | 0.00035777679239198614 | Samples 385024 | Train acc: 0.6023848684210527 | Val loss: 0.02939091678708792 | Val acc: 0.5948 | learning rate: 0.002958323167228781
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 1524 | Train loss | 0.000374986535457314 | Samples 390144 | Train acc: 0.596875 | Val loss: 0.031790691800415515 | Val acc: 0.5966 | learning rate: 0.002957183730275979
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 1543 | Train loss | 0.0003891224017453626 | Samples 395008 | Train acc: 0.5805921052631579 | Val loss: 0.030221564508974553 | Val acc: 0.5894 | learning rate: 0.002956087240431255
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.79it/s]
Step 1563 | Train loss | 0.00039040043478464834 | Samples 400128 | Train acc: 0.59453125 | Val loss: 0.029817420803010464 | Val acc: 0.6064 | learning rate: 0.002954918289209236
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.80it/s]
Step 1583 | Train loss | 0.0003614409937231679 | Samples 405248 | Train acc: 0.6087890625 | Val loss: 0.029991209879517554 | Val acc: 0.5942 | learning rate: 0.0029537342203068613
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 1602 | Train loss | 0.00036845347162566184 | Samples 410112 | Train acc: 0.5958059210526315 | Val loss: 0.028374210745096207 | Val acc: 0.6068 | learning rate: 0.0029525953633024373
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 1622 | Train loss | 0.00033569512791238446 | Samples 415232 | Train acc: 0.6142578125 | Val loss: 0.030527223832905293 | Val acc: 0.5856 | learning rate: 0.00295138185045385
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.89it/s]
Step 1641 | Train loss | 0.00033777630031471854 | Samples 420096 | Train acc: 0.6085526315789473 | Val loss: 0.029488601814955474 | Val acc: 0.593 | learning rate: 0.0029502150443360096
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.89it/s]
Step 1661 | Train loss | 0.0003632068114016748 | Samples 425216 | Train acc: 0.6037109375 | Val loss: 0.029974807240068912 | Val acc: 0.5958 | learning rate: 0.0029489721354879527
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 1680 | Train loss | 0.0003571527356870255 | Samples 430080 | Train acc: 0.5904605263157895 | Val loss: 0.032596738263964656 | Val acc: 0.5868 | learning rate: 0.0029477774263580235
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 1700 | Train loss | 0.00040238981585794166 | Samples 435200 | Train acc: 0.5693359375 | Val loss: 0.033995757717639206 | Val acc: 0.5664 | learning rate: 0.002946505170618694
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 1719 | Train loss | 0.00034722662639132765 | Samples 440064 | Train acc: 0.5869654605263158 | Val loss: 0.033115860633552076 | Val acc: 0.5732 | learning rate: 0.00294528260568047
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 1739 | Train loss | 0.0003877677676407085 | Samples 445184 | Train acc: 0.57734375 | Val loss: 0.032828289456665515 | Val acc: 0.5746 | learning rate: 0.002943981053317584
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 1758 | Train loss | 0.00034788944941139004 | Samples 450048 | Train acc: 0.57421875 | Val loss: 0.032543027121573684 | Val acc: 0.5702 | learning rate: 0.0029427306808754612
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.86it/s]
Step 1778 | Train loss | 0.0003088307087930017 | Samples 455168 | Train acc: 0.6140625 | Val loss: 0.029149509407579897 | Val acc: 0.598 | learning rate: 0.0029413998833142632
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 1797 | Train loss | 0.0003134869660631038 | Samples 460032 | Train acc: 0.5916940789473685 | Val loss: 0.027172604016959666 | Val acc: 0.6086 | learning rate: 0.002940121752771333
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.77it/s]
Step 1817 | Train loss | 0.00030379195577732407 | Samples 465152 | Train acc: 0.6130859375 | Val loss: 0.02879598829895258 | Val acc: 0.59 | learning rate: 0.0029387617625925657
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.88it/s]
Step 1836 | Train loss | 0.00028324716916600844 | Samples 470016 | Train acc: 0.6064967105263158 | Val loss: 0.02720119562000036 | Val acc: 0.6188 | learning rate: 0.00293745592444866
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 1856 | Train loss | 0.00028385221757552413 | Samples 475136 | Train acc: 0.6052734375 | Val loss: 0.025992370024323464 | Val acc: 0.625 | learning rate: 0.002936066795386488
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.85it/s]
Step 1875 | Train loss | 0.0002666677850713608 | Samples 480000 | Train acc: 0.6200657894736842 | Val loss: 0.02849591663107276 | Val acc: 0.6114 | learning rate: 0.002934733301236185
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.83it/s]
Step 1895 | Train loss | 0.00031137395795544743 | Samples 485120 | Train acc: 0.5958984375 | Val loss: 0.03007225478067994 | Val acc: 0.5876 | learning rate: 0.0029333150881760708
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.90it/s]
Step 1915 | Train loss | 0.00030721485272578754 | Samples 490240 | Train acc: 0.60546875 | Val loss: 0.027658103685826062 | Val acc: 0.6102 | learning rate: 0.0029318819819088853
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.66it/s]
Step 1934 | Train loss | 0.00030606161774128905 | Samples 495104 | Train acc: 0.5884046052631579 | Val loss: 0.030008410289883613 | Val acc: 0.5958 | learning rate: 0.0029305067496831917
 10%|██████████████████▊                                                                                                                                                                        | 1962/19531 [10:28:24<93:16:12, 19.11s/it]Traceback (most recent call last):
Step 1954 | Train loss | 0.00029297308124544676 | Samples 500224 | Train acc: 0.614453125 | Val loss: 0.02871326431632042 | Val acc: 0.598 | learning rate: 0.002929044644633374
  File "rnn/train.py", line 244, in <module>
    main()
  File "rnn/train.py", line 241, in main
    train(model, optimizer, scheduler, train_loader, val_loader, args)
  File "rnn/train.py", line 93, in train
    loss.backward()
  File "/root/miniconda3/lib/python3.8/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/root/miniconda3/lib/python3.8/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/root/miniconda3/lib/python3.8/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
